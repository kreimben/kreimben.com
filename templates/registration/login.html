{% extends 'site_base.html' %}

{% block title %}
    Login
{% endblock %}

{% block menu %}
    {% include 'menu.html' %}
{% endblock %}

{% block content %}
    {% load crispy_forms_tags %}
    <h2>Sign In</h2>
    <form method="post">
        {% csrf_token %}
        {{ form|crispy }}
        <button type="submit">Log In</button>
        <br/>
        <input type="hidden" name="passkeys" id="passkeys"/>
        <button class="btn btn-block btn-dark" type="button" onclick="authn('loginForm')">
            {% load static %}
            <img src="{% static 'passkeys/imgs/FIDO-Passkey_Icon-White.png' %}" style="width: 24px">
        </button>
        {% include 'passkeys.js' %}
    </form>

    <div id="pk" class="alert alert-info" style="display: none">Your device supports passkeys, <a
            href="{% url 'passkeys:enroll' %}">Enroll</a></div>
    <script type="text/javascript">
        function register_pk() {
            $('#pk').show();
        }

        {% include 'check_passkeys.js'%}
        $(document).ready(check_passkey(true, register_pk))
    </script>
{% endblock %}